import{W as be}from"./Wiki-8KnGzdnu.js";import{f as V,r as T,$ as te,w as j,v as C,L as M,o as v,aC as Ee,aD as De,aq as oe,ar as ne,as as ie,at as ae,au as se,av as ce,aw as re,ax as le,j as F,g as P,h as b,I as l,F as x,C as de,a8 as Ae,a9 as $e,a5 as ue,Y as pe,ay as Te,n as me,B,aE as Ce,a as ze,s as _e,x as E,i as z,y as ve,A as H,aF as Y,K as Z,D as fe,P as Pe,_ as m,a4 as he,aa as J,z as Ie,ac as K,p as Q}from"./vendor-DwjfiTos.js";import{d as Le,u as ge,a as Ve,g as G,_ as Re,v as Se,o as X}from"./index-lYYcvhZ6.js";import{I as Oe}from"./Image-RN-sZ7Xy.js";import{B as xe}from"./Bucket-GNIK0PFr.js";const Be="juejin",Ne="github",Fe="smartblue",He="cyanosis",Me="channing-cyan",je="fancy",qe="condensed-night-purple",Ue="greenwillow",Ke="vue-pro",Ge="healer-readable",We="mk-cute",Ye="jzman",Ze="geek-black",Je="awesome-geen",Qe="qklhk-chocolate",Xe="orange",et="scrolls-light",tt="simplicity-green",ot="arknights",nt="vuepress",it="Chinese-red",at="nico",st="devui-blue",ke={juejin:Be,github:Ne,smartblue:Fe,cyanosis:He,channingCyan:Me,fancy:je,condensedNightPurple:qe,greenwillow:Ue,vuePro:Ke,healerReadable:Ge,mkCute:We,jzman:Ye,geekBlack:Ze,awesomeGeen:Je,qklhkChocolate:Qe,orange:Xe,scrollsLight:et,simplicityGreen:tt,arknights:ot,vuepress:nt,ChineseRed:it,nico:at,devuiBlue:st};function ct({locale:f,...u}={}){const c={...ke,...f},p=[];for(const r in c)p.push({title:r,name:c[r]});return{viewerEffect:({file:r})=>{r&&u.callback(u.theme)},actions:[{title:"Markdown主题",icon:'<svg t="1706237411212" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4232" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M264.090273 111.378908h146.607307c18.711012 0 34.14437 13.959435 37.6713 32.525996 4.352736 13.905745 12.482957 26.391258 23.038182 34.830836a62.572018 62.572018 0 0 0 40.372425 14.521903 63.719964 63.719964 0 0 0 40.651103-14.521903 69.494211 69.494211 0 0 0 23.885718-37.745444c4.602012-17.978525 20.036647-29.606275 36.570653-29.606274h146.603472c11.931993 0 21.961822 4.635248 28.991395 13.959435l208.417437 222.941897a42.288652 42.288652 0 0 1 0 57.738627L853.822723 559.302927a36.064431 36.064431 0 0 1-53.681187 0l-0.525397-0.884609-1.624765-1.150503v314.419662c0 22.666186-16.784559 40.938728-38.497106 40.938728H264.090273c-21.136017 0-37.920576-18.272543-37.920576-40.938728V557.266537l-2.45185 2.03639a36.371232 36.371232 0 0 1-53.954751 0L26.682719 406.020146c-14.633119-15.940857-14.633119-41.801606 0-57.738627l1.876598-1.76794L236.975476 123.006658a37.470601 37.470601 0 0 1 27.114797-11.632863z m120.868 81.289422h-105.158522L107.42757 377.29848l89.17548 95.195168 40.372426-43.238456a37.786351 37.786351 0 0 1 27.114797-11.8962c21.111728 0 37.946143 18.272543 37.946142 40.644711v372.443358h419.511711V457.998589a41.312003 41.312003 0 0 1 11.377195-28.748511c14.658685-15.96898 39.022502-15.96898 54.20147 0l39.859813 43.24357 89.699598-95.195168-172.625291-184.63015h-105.434643a144.386837 144.386837 0 0 1-40.12315 51.100226c-24.113263 19.746465-54.20147 31.642665-86.723631 31.642665-32.492759 0-62.334248-11.8962-86.448789-31.642665a148.496689 148.496689 0 0 1-40.372425-51.093834z" fill="#3B3F51" p-id="4233"></path></svg>',handler:{type:"dropdown",actions:p.map(({title:r,name:i})=>({title:i===u.theme?`${r}(当前)`:r,handler:{type:"action",click({editor:t,appendBlock:g,codemirror:k}){u.callback(i)}}})),...c}}]}}const rt=V({__name:"bytemd-editor",props:{value:{},markdownTheme:{},codeTheme:{}},emits:["update:value","theme-change"],setup(f,{emit:u}){const c=f,p=u,r=Le(),i=ge(),t=new Oe,g=new xe,k=Ve(),y=T([]);function _(o){p("update:value",o)}function w(o,a,n=1e3){i.$notify({title:"错误提示",message:o,type:a,duration:n})}async function A(o){try{const{current_bucket:a}=r.user_habits.data,$=(await g.find({visible:!0,is_only_names:!0})).items.map(h=>h.id),{system:{accept:I,maxcount:R,maxsize:s}}=k.systemConfig;if(!a||!$.includes(a))return w("请先选择存储桶，然后再上传","warning"),[];if(R<o.length)return w("选择文件长度超出数量限制","warning"),[];const e=o.filter(h=>{const L=h.size/1024/1024;return!I.includes(G(h.name))||L>s}).map(h=>{const L=h.size/1024/1024,O=G(h.name);if(L>s)return`${h.name}大小${L.toFixed(2)}MB不符合要求`;if(!I.includes(O))return`${h.name}格式${O}不符合要求`});if(e.length)return w(e.join(";"),"error"),[];const d=o.filter(h=>{const L=h.size/1024/1024;return I.includes(G(h.name))&&L<=s});w("图片上传中，请勿操作...","warning");const D=new FormData;D.append("bucket_id",a.toString()),d.forEach(h=>{D.append("files",h)});const N=await t.upload(D,({loaded:h,total:L,percent:O})=>{});return w("图片上传成功...","success"),N.map(h=>({url:h.baseurl+h.url,name:h.name}))}catch(a){w("出错啦: "+a,"error")}}return te(()=>{const o=document.querySelector(".bytemd-toolbar-right");if(o){const a=o.querySelector(".bytemd-toolbar-icon");a&&a.click()}}),j(()=>c.markdownTheme,o=>{y.value=[oe(),ne(),ie(),ae(),se(),ce(),re(),le(),ct({locale:{...ke},theme:o,callback(a){p("theme-change",a)}})]},{immediate:!0}),(o,a)=>(v(),C(M(De),{class:"bytemd-editor",value:o.value,mode:"auto",previewDebounce:300,plugins:y.value,placeholder:"请输入您的markdown内容....",locale:M(Ee),uploadImages:A,onChange:_},null,8,["value","plugins","placeholder","locale"]))}}),lt=f=>(Ae("data-v-ae7890d0"),f=f(),$e(),f),dt={class:"bytemd-navigator"},ut=lt(()=>l("div",{class:"bytemd-navigator-title"},"本页目录",-1)),pt={class:"bytemd-navigator-main"},mt={class:"nav-list"},_t=["data-level","title","onClick"],vt=V({__name:"bytemd-preview",props:{value:{}},emits:["update:value"],setup(f,{emit:u}){const c=f,p=ue();pe();const r=T(0),i=[oe(),ne(),ie(),ae(),se(),ce(),re(),le()],t=T([]);function g(o){Ce({plugins:[{rehype:a=>a.use(()=>n=>{n&&n.children.length&&k(n)})}]}).processSync(o)}function k(o){const a=[];o.children.filter(n=>n.type==="element").forEach((n,$)=>{if(["h1","h2","h3","h4","h5","h6"].includes(n.tagName)&&n.children.length>0){const I=n.tagName.charAt(1),R=y(n);a.push({level:I,text:R})}}),t.value=a}function y(o){let a="";return o.children.forEach(n=>{n.type==="text"&&(a+=n.value)}),a}function _(){const o=document.querySelector("#bytemd-container").querySelector(".markdown-body");Array.from(o.children).filter(n=>["H1","H2","H3","H4","H5","H6"].includes(n.tagName)).forEach((n,$)=>{n.setAttribute("id",`head-${$}`),t.value[$]&&(t.value[$].offsetTop=n.offsetTop)})}function w(o){F(()=>{if(o){const a=document.querySelector(o);if(a){const n=a.offsetTop;document.querySelector(".bytemd-viewer").scrollTo(0,n-20)}}})}function A(o){const a=o.target.scrollTop;for(let n=0;n<t.value.length;n++)t.value[n].offsetTop<=a+20&&(r.value=n)}return j(()=>c.value,o=>{o&&F(()=>{g(o),_(),w(p.hash)})},{immediate:!0}),te(()=>{F(()=>{_()})}),(o,a)=>(v(),P(x,null,[b(M(Te),{class:"bytemd-viewer markdown-body",value:o.value,plugins:i,ref:"viewerRef",onScroll:A},null,8,["value"]),l("div",dt,[ut,l("div",pt,[l("ul",mt,[(v(!0),P(x,null,de(t.value,(n,$)=>(v(),P("li",{class:me(["level-"+n.level,$===r.value?"active":""]),"data-level":$,title:n.text,onClick:I=>w(`#head-${$}`)},[l("span",null,B(n.text),1)],10,_t))),256))])])])],64))}}),ft=Re(vt,[["__scopeId","data-v-ae7890d0"]]),ht={class:"wiki-article-preview"},gt={class:"wiki-article-preview__header"},kt={class:"left-content"},wt={class:"wiki-article-title"},yt={class:"wiki-article-time"},bt={class:"right-content"},Et={class:"wiki-article-preview__content",id:"bytemd-container"},Dt=V({__name:"article-preview",props:{article:{default:()=>({title:"",updatedAt:"",markdown:""})},edit:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["update:edit","update","theme-change"],setup(f,{emit:u}){const c=f,p=u;ze({theme:!1});function r(i){switch(i){case"edit":p("update:edit",!0);break;case"cancel":p("update:edit",!1);break;case"preview":p("update:edit",!1),p("update");break}}return j(()=>c.article,i=>{F(()=>{var y;const t=i.theme.markdown,g=document.querySelector("#bytemd-theme"),k=((y=Y[t])==null?void 0:y.style)??Y.juejin.style;g.innerHTML=k.replaceAll(".markdown-body","#bytemd-container .markdown-body")})},{deep:!0}),(i,t)=>{const g=z("el-input"),k=z("el-button"),y=ve("loading");return _e((v(),P("div",ht,[l("div",gt,[l("div",kt,[i.edit?(v(),C(g,{key:0,modelValue:i.article.title,"onUpdate:modelValue":t[0]||(t[0]=_=>i.article.title=_)},null,8,["modelValue"])):(v(),P(x,{key:1},[l("div",wt,B(i.article.title),1),l("div",yt," 更新于 "+B(M(Se)(i.article.updatedAt)),1)],64))]),l("div",bt,[i.edit?(v(),P(x,{key:0},[b(k,{type:"danger",icon:"Back",onClick:t[1]||(t[1]=_=>r("cancel"))},{default:E(()=>[H("取消")]),_:1}),b(k,{type:"success",icon:"Checked",onClick:t[2]||(t[2]=_=>r("preview"))},{default:E(()=>[H("保存")]),_:1})],64)):(v(),C(k,{key:1,type:"primary",icon:"EditPen",onClick:t[3]||(t[3]=_=>r("edit"))},{default:E(()=>[H("编辑")]),_:1}))])]),l("div",Et,[i.edit?(v(),C(rt,{key:0,value:i.article.markdown,"onUpdate:value":t[4]||(t[4]=_=>i.article.markdown=_),"markdown-theme":i.article.theme.markdown,"code-theme":i.article.theme.code,onThemeChange:t[5]||(t[5]=_=>i.$emit("theme-change",_))},null,8,["value","markdown-theme","code-theme"])):(v(),C(ft,{key:1,value:i.article.markdown,"onUpdate:value":t[6]||(t[6]=_=>i.article.markdown=_)},null,8,["value"]))])])),[[y,i.loading]])}}}),At={class:"wiki-icon"},we=V({__name:"wiki-icon",props:{color:{default:"#606266"},size:{default:"16"}},setup(f){Pe(r=>({db19b752:p.value,"89db1466":c.value}));const u=f,c=Z(()=>u.color),p=Z(()=>parseInt(u.size)+"px");return(r,i)=>(v(),P("span",At,[fe(r.$slots,"default")]))}}),$t=l("svg",{t:"1693878652630",class:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[l("path",{d:"M426.666667 170.666667H170.666667c-47.146667 0-84.906667 38.186667-84.906667 85.333333L85.333333 768c0 47.146667 38.186667 85.333333 85.333334 85.333333h682.666666c47.146667 0 85.333333-38.186667 85.333334-85.333333V341.333333c0-47.146667-38.186667-85.333333-85.333334-85.333333H512l-85.333333-85.333333z","p-id":"4270"})],-1),Tt=V({__name:"icon-folder",props:{color:{default:"#606266"},size:{default:"16"}},setup(f){return(u,c)=>(v(),C(we,{size:u.size,color:u.color},{default:E(()=>[$t]),_:1},8,["size","color"]))}}),Ct=l("svg",{t:"1693879787380",class:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[l("path",{d:"M842.666667 285.866667l-187.733334-187.733334c-14.933333-14.933333-32-21.333333-53.333333-21.333333H234.666667C194.133333 74.666667 160 108.8 160 149.333333v725.333334c0 40.533333 34.133333 74.666667 74.666667 74.666666h554.666666c40.533333 0 74.666667-34.133333 74.666667-74.666666V337.066667c0-19.2-8.533333-38.4-21.333333-51.2z m-44.8 44.8c-2.133333 2.133333-4.266667 0-8.533334 0h-170.666666c-6.4 0-10.666667-4.266667-10.666667-10.666667V149.333333c0-2.133333 0-6.4-2.133333-8.533333 0 0 2.133333 0 2.133333 2.133333l189.866667 187.733334z m-8.533334 554.666666H234.666667c-6.4 0-10.666667-4.266667-10.666667-10.666666V149.333333c0-6.4 4.266667-10.666667 10.666667-10.666666h311.466666c-2.133333 4.266667-2.133333 6.4-2.133333 10.666666v170.666667c0 40.533333 34.133333 74.666667 74.666667 74.666667h170.666666c4.266667 0 6.4 0 10.666667-2.133334V874.666667c0 6.4-4.266667 10.666667-10.666667 10.666666z",fill:"#666666","p-id":"5233"}),l("path",{d:"M640 693.333333H341.333333c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32h298.666667c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32zM640 522.666667H341.333333c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32h298.666667c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32zM341.333333 416h85.333334c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32h-85.333334c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32z",fill:"#666666","p-id":"5234"})],-1),ee=V({__name:"icon-file",props:{color:{default:"#606266"},size:{default:"16"}},setup(f){return(u,c)=>(v(),C(we,{size:u.size,color:u.color},{default:E(()=>[Ct]),_:1},8,["size","color"]))}}),zt=(f,u)=>{const c=f[u];return c?typeof c=="function"?c():Promise.resolve(c):new Promise((p,r)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(r.bind(null,new Error("Unknown variable dynamic import: "+u)))})},Pt={class:"menu-item-text"},W=V({__name:"action-popover",props:{placement:{default:"bottom-end"},trigger:{default:"click"},actions:{default:()=>[]},parent:{default:()=>({id:0})}},emits:["action"],setup(f,{emit:u}){const c=f,p=u,r=T({});async function i(){["file","folder","excel","mindmap","diagram","magic","import","canvas","copy","delete","export","docx","pdf","markdown","html"].forEach(async k=>{const{default:y}=await zt(Object.assign({"./icons/icon-canvas.vue":()=>m(()=>import("./icon-canvas-sE7yaEcw.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])),"./icons/icon-computer.vue":()=>m(()=>import("./icon-computer-RfJwp8Wh.js"),__vite__mapDeps([8,1,2,3,4,5,6,7])),"./icons/icon-copy.vue":()=>m(()=>import("./icon-copy-aVoFgZT6.js"),__vite__mapDeps([9,1,2,3,4,5,6,7])),"./icons/icon-delete.vue":()=>m(()=>import("./icon-delete-TlbGyX4z.js"),__vite__mapDeps([10,1,2,3,4,5,6,7])),"./icons/icon-diagram.vue":()=>m(()=>import("./icon-diagram-g1RIdOEL.js"),__vite__mapDeps([11,1,2,3,4,5,6,7])),"./icons/icon-docx.vue":()=>m(()=>import("./icon-docx-29zSyyHz.js"),__vite__mapDeps([12,1,2,3,4,5,6,7])),"./icons/icon-edit.vue":()=>m(()=>import("./icon-edit-f3oI6E4Y.js"),__vite__mapDeps([13,1,2,3,4,5,6,7])),"./icons/icon-excel.vue":()=>m(()=>import("./icon-excel-iAxTodhE.js"),__vite__mapDeps([14,1,2,3,4,5,6,7])),"./icons/icon-export.vue":()=>m(()=>import("./icon-export-2shQilQU.js"),__vite__mapDeps([15,1,2,3,4,5,6,7])),"./icons/icon-file.vue":()=>m(()=>import("./icon-file-JR4gU6-h.js"),__vite__mapDeps([16,3,4,1,2,5,6,7])),"./icons/icon-folder.vue":()=>m(()=>import("./icon-folder-jWwwtNgR.js"),__vite__mapDeps([17,3,4,1,2,5,6,7])),"./icons/icon-html.vue":()=>m(()=>import("./icon-html-T-2OsdJ3.js"),__vite__mapDeps([18,1,2,3,4,5,6,7])),"./icons/icon-import.vue":()=>m(()=>import("./icon-import-GPN9aGa-.js"),__vite__mapDeps([19,1,2,3,4,5,6,7])),"./icons/icon-info.vue":()=>m(()=>import("./icon-info-6ZhMCl2V.js"),__vite__mapDeps([20,1,2,3,4,5,6,7])),"./icons/icon-list.vue":()=>m(()=>import("./icon-list-hGzg6Twr.js"),__vite__mapDeps([21,1,2,3,4,5,6,7])),"./icons/icon-lock.vue":()=>m(()=>import("./icon-lock-j78j6Jvd.js"),__vite__mapDeps([22,1,2,3,4,5,6,7])),"./icons/icon-magic.vue":()=>m(()=>import("./icon-magic-52qjGlFB.js"),__vite__mapDeps([23,1,2,3,4,5,6,7])),"./icons/icon-markdown.vue":()=>m(()=>import("./icon-markdown-KpDKY4Bj.js"),__vite__mapDeps([24,1,2,3,4,5,6,7])),"./icons/icon-mindmap.vue":()=>m(()=>import("./icon-mindmap-GzSlOCVV.js"),__vite__mapDeps([25,1,2,3,4,5,6,7])),"./icons/icon-move.vue":()=>m(()=>import("./icon-move-d97ltX6v.js"),__vite__mapDeps([26,1,2,3,4,5,6,7])),"./icons/icon-pdf.vue":()=>m(()=>import("./icon-pdf-jOnIWHvM.js"),__vite__mapDeps([27,1,2,3,4,5,6,7])),"./icons/icon-play.vue":()=>m(()=>import("./icon-play-7y5Jj7aK.js"),__vite__mapDeps([28,1,2,3,4,5,6,7])),"./icons/icon-print.vue":()=>m(()=>import("./icon-print-Mdf-XIE_.js"),__vite__mapDeps([29,1,2,3,4,5,6,7])),"./icons/icon-save.vue":()=>m(()=>import("./icon-save-L1AleSJE.js"),__vite__mapDeps([30,1,2,3,4,5,6,7])),"./icons/icon-share.vue":()=>m(()=>import("./icon-share-_slt1okP.js"),__vite__mapDeps([31,1,2,3,4,5,6,7]))}),`./icons/icon-${k}.vue`);r.value[k]=y})}i();function t(g){p("action",{...g,...c.parent})}return(g,k)=>{const y=z("el-dropdown-item"),_=z("el-dropdown-menu"),w=z("el-dropdown");return v(),C(w,{"popper-class":"action-popover",placement:g.placement,trigger:g.trigger},{dropdown:E(()=>[b(_,null,{default:E(()=>[(v(!0),P(x,null,de(g.actions,(A,o)=>(v(),C(y,{key:"action-item-"+o,onClick:a=>t(A)},{default:E(()=>[(v(),C(he(r.value[A.icon]),{size:A.size,color:A.color},null,8,["size","color"])),l("span",Pt,B(A.text),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),default:E(()=>[fe(g.$slots,"reference")]),_:3},8,["placement","trigger"])}}}),It={class:"wiki-article-sidebar"},Lt={class:"wiki-article-sidebar__header"},Vt={class:"wiki-search-entry"},Rt=l("span",{class:"wiki-search-entry-content"},"搜索内容",-1),St=l("span",{class:"wiki-search-entry-hotkey"},"Ctrl+Shift+F",-1),Ot={class:"wiki-article-sidebar__content"},xt={class:"wiki-page-title"},Bt=l("span",null,"文档目录",-1),Nt={class:"action"},Ft={class:"node-item-label"},Ht={key:0,class:"node-item-actions"},Mt=V({__name:"article-sidebar",props:{treeData:{},article:{default:()=>({id:0})},expandedKeys:{},loading:{type:Boolean}},emits:["update","action","drag-sort"],setup(f,{emit:u}){const c=pe(),p=f,r=u,i=T(null),t=T([{icon:"file",size:18,text:"新建文档",func:"createFile"},{icon:"folder",size:18,text:"新建分组",func:"createFolder",color:"#F6C659"}]),g=T([{icon:"file",size:18,text:"新建文档",func:"createFile"},{icon:"folder",size:18,text:"新建分组",func:"createFolder",color:"#F6C659"}]),k=T([{icon:"copy",size:18,text:"复制文档",func:"copyFile"},{icon:"delete",size:18,text:"删除文档",func:"deleteFile"}]);function y(){c.push({name:"Wiki"})}function _(s){r("update",s)}function w(s){let e=null;switch(s){case"folder":e=K(Tt);break;case"file":e=K(ee);break;default:e=K(ee);break}return e}function A(s){let e=null;switch(s){case"folder":e="rgb(246, 198, 89)";break;case"file":e="rgb(156, 156, 251)";break;case"excel":e="#01a408";break;case"mindmap":e="rgb(156, 156, 251)";break;case"diagram":e="rgb(156, 156, 251)";break;default:e="rgb(156, 156, 251)";break}return e}function o(s,e){}function a(s,e,d){}function n(s,e,d){}function $(s,e,d){}function I(s,e,d,D){}function R(s,e,d,D){console.log("from:",s.data.title,"to:",e.data.title,"类型:",d),r("drag-sort",{from:s.data.id,to:e.data.id,type:d})}return j(()=>p.article,s=>{s&&i.value.setCurrentKey(s.id)},{deep:!0,immediate:!0}),(s,e)=>{const d=z("DArrowLeft"),D=z("el-icon"),N=z("Search"),h=z("Plus"),L=z("MoreFilled"),O=z("el-tree"),ye=ve("loading");return v(),P("div",It,[l("div",Lt,[l("div",{class:"wiki-go-back",onClick:y},[b(D,null,{default:E(()=>[b(d)]),_:1}),H("返回")]),l("div",Vt,[b(D,{class:"wiki-search-entry-icon",size:16},{default:E(()=>[b(N)]),_:1}),Rt,St])]),l("div",Ot,[l("div",xt,[Bt,b(W,{actions:t.value,trigger:"click",onAction:e[0]||(e[0]=q=>s.$emit("action",q))},{reference:E(()=>[l("div",Nt,[b(D,null,{default:E(()=>[b(h)]),_:1})])]),_:1},8,["actions"])]),_e((v(),C(O,{class:"wiki-page-tree",ref_key:"treeRef",ref:i,data:s.treeData,props:{children:"children",label:"title"},"highlight-current":"","default-expanded-keys":s.expandedKeys,"node-key":"id","current-node-key":s.article.id,"expand-on-click-node":!1,draggable:"",onNodeClick:_,onNodeDragStart:o,onNodeDragEnter:a,onNodeDragLeave:n,onNodeDragOver:$,onNodeDragEnd:I,onNodeDrop:R},{default:E(({node:q,data:S})=>[l("div",{class:me({"node-item":!0,active:s.article.id===S.id})},[(v(),C(he(w(S.type)),{class:"node-item-icon",size:18,color:A(S.type)},null,8,["color"])),l("span",Ft,B(q.label),1),S.id===s.article.id?(v(),P("div",Ht,[b(W,{actions:g.value,trigger:"click",parent:S,onAction:e[2]||(e[2]=U=>s.$emit("action",U))},{reference:E(()=>[l("div",{class:"node-item-action",onClick:e[1]||(e[1]=J(()=>{},["stop"]))},[b(D,{size:"12"},{default:E(()=>[b(h)]),_:1})])]),_:2},1032,["actions","parent"]),b(W,{actions:k.value,trigger:"click",parent:S,onAction:e[4]||(e[4]=U=>s.$emit("action",U))},{reference:E(()=>[l("div",{class:"node-item-action",onClick:e[3]||(e[3]=J(()=>{},["stop"]))},[b(D,{size:"12"},{default:E(()=>[b(L)]),_:1})])]),_:2},1032,["actions","parent"])])):Ie("",!0)],2)]),_:1},8,["data","default-expanded-keys","current-node-key"])),[[ye,s.loading]])])])}}}),jt={class:"wiki-article"},qt=V({__name:"wiki-articles",setup(f){const u=ue(),c=new be,p=ge(),{wid:r}=u.params,i=T([]),t=T({id:0,title:"",theme:{code:"github",markdown:"github"}}),g=T(!1),k=T(!1),y=T(!1),_=T([]);function w(){y.value=!0,c.getArticlePageTree(+r).then(e=>{i.value=e,y.value=!1,e.length&&(t.value.id=e[0].id,A(e[0]))})}w();function A(e){k.value=!0,t.value.id=e.id,c.getArticleDetail(e.id).then(d=>{d.markdown===" "&&(d.markdown=""),t.value=d,k.value=!1,_.value.push(d.id)})}function o(){c.updateArticle({id:t.value.id,title:t.value.title,markdown:t.value.markdown}).then(e=>{p.$message({message:"文档更新成功",type:"success",duration:1e3}),w()})}function a(e,d="未命名文档",D=0){c.createArticle({title:d,type:e,pid:D,markdown:""},+r).then(N=>{p.$message({message:"文档新建成功",type:"success",duration:1e3}),w()})}function n(e){c.deleteArticle(e).then(d=>{p.$message({message:"文档删除成功",type:"success",duration:1e3}),w()})}function $(e){c.copyArticle(e).then(d=>{w(),p.$message({message:"文档复制成功",type:"success",duration:1e3})})}function I(e){switch(e.func){case"createFile":Q.prompt("请输出文档名称","新建文档",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^\S+$/,inputErrorMessage:"请输出文档名称"}).then(({value:d})=>{a("file",d,e.id),e.id&&_.value.push(e.id)}).catch(()=>{});break;case"createFolder":Q.prompt("请输出分组名称","新建分组",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^\S+$/,inputErrorMessage:"请输出分组名称"}).then(({value:d})=>{a("folder",d,e.id)}).catch(()=>{});break;case"deleteFile":X("确定删除吗?该操作会将其子节点一并删除").then(()=>{n(e.id)});break;case"copyFile":X("该操作只会复制当前节点，其子节点不会复制，确定复制吗？").then(()=>{$(e.id)});break}}function R(e){e!==t.value.theme.markdown&&(t.value.theme.code=e,t.value.theme.markdown=e,c.changTheme(t.value.id,e).then(d=>{p.$message({message:"主题切换成功",type:"success",duration:1e3})}))}function s(e){c.sortArticle(e).then(d=>{w()})}return(e,d)=>(v(),P("div",jt,[b(Mt,{"tree-data":i.value,article:t.value,loading:y.value,expandedKeys:_.value,onUpdate:A,onAction:I,onDragSort:s},null,8,["tree-data","article","loading","expandedKeys"]),b(Dt,{article:t.value,edit:g.value,"onUpdate:edit":d[0]||(d[0]=D=>g.value=D),loading:k.value,onUpdate:o,onThemeChange:R},null,8,["article","edit","loading"])]))}}),Zt=Object.freeze(Object.defineProperty({__proto__:null,default:qt},Symbol.toStringTag,{value:"Module"}));export{we as _,ee as a,Tt as b,Zt as w};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["static/js/icon-canvas-sE7yaEcw.js","static/js/vendor-DwjfiTos.js","static/css/vendor-5Uc64JMc.css","static/js/Wiki-8KnGzdnu.js","static/js/index-lYYcvhZ6.js","static/css/index-oufE5t9O.css","static/js/Image-RN-sZ7Xy.js","static/js/Bucket-GNIK0PFr.js","static/js/icon-computer-RfJwp8Wh.js","static/js/icon-copy-aVoFgZT6.js","static/js/icon-delete-TlbGyX4z.js","static/js/icon-diagram-g1RIdOEL.js","static/js/icon-docx-29zSyyHz.js","static/js/icon-edit-f3oI6E4Y.js","static/js/icon-excel-iAxTodhE.js","static/js/icon-export-2shQilQU.js","static/js/icon-file-JR4gU6-h.js","static/js/icon-folder-jWwwtNgR.js","static/js/icon-html-T-2OsdJ3.js","static/js/icon-import-GPN9aGa-.js","static/js/icon-info-6ZhMCl2V.js","static/js/icon-list-hGzg6Twr.js","static/js/icon-lock-j78j6Jvd.js","static/js/icon-magic-52qjGlFB.js","static/js/icon-markdown-KpDKY4Bj.js","static/js/icon-mindmap-GzSlOCVV.js","static/js/icon-move-d97ltX6v.js","static/js/icon-pdf-jOnIWHvM.js","static/js/icon-play-7y5Jj7aK.js","static/js/icon-print-Mdf-XIE_.js","static/js/icon-save-L1AleSJE.js","static/js/icon-share-_slt1okP.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}

import{_ as p,a as g,b as F}from"./recent-year.vue_vue_type_style_index_0_lang-cTnf2oCu.js";import{L as O}from"./Log-zS3L1r1V.js";import{f as b,r as f,$ as M,an as D,w as A,o as y,g as w,j as I,e as z,aI as k,I as P,s as j,h as t,x as r,i as B,y as N}from"./vendor-DwjfiTos.js";import"./index-08v4467x.js";const T={id:"recent-user",class:"stats-chart"},Y=b({__name:"recent-user",props:{data:{}},setup(h){const m=h,c=f();function s(){for(var o=new Date,u=[],i=0;i<12;i++){var e=o.getFullYear(),a=o.getMonth()-i;a<0&&(a+=12,e--),u.push(e+"-"+("0"+(a+1)).slice(-2))}return u.reverse()}function d(o,u){return u.map(i=>{const e=o.find(a=>a.month===i);return e?e.count:0})}return M(()=>{const o=document.getElementById("recent-user");c.value=D(o,"westeros"),c.value.setOption({tooltip:{trigger:"item"},grid:{bottom:30,left:50,right:50},xAxis:{type:"category",axisLine:{lineStyle:{color:"#777"}}},yAxis:{type:"value",axisLine:{show:!0,lineStyle:{color:"#777"}}}});const u=new ResizeObserver(i=>{c.value.resize()});o&&u.observe(o)}),A(()=>m.data,o=>{o&&I(()=>{const{user:u}=o,i=s();c.value.setOption({xAxis:{data:i},series:[{type:"bar",name:"用户数量",data:d(u,i)}]})})},{immediate:!0,deep:!0}),(o,u)=>(y(),w("div",T))}}),R={class:"china-map"},V=P("div",{id:"chart"},null,-1),U=[V],q=b({__name:"map-chart",setup(h){const m=f();f({});var c=[{name:"北京",value:177},{name:"四川",value:102},{name:"内蒙古",value:47},{name:"浙江",value:114},{name:"宁夏",value:18},{name:"新疆",value:67},{name:"广东",value:123},{name:"广西",value:59},{name:"海南",value:14}],s="china";async function d(){const e=(await z.get("/data/china.json")).data;return e.features.forEach(a=>{var l=a.properties.name;i[l]=a.properties.cp}),e}function o(e){for(var a=[],l=0;l<e.length;l++){var n=i[e[l].name];n&&a.push({name:e[l].name,value:n.concat(e[l].value)})}return a}async function u(e){m.value=D(e);const a=await d();console.log(a),console.log((await z.get("/data/china2.json")).data),k("china",a),m.value.showLoading();const l={visualMap:{show:!0,min:0,max:200,left:"left",top:"bottom",text:["高","低"],seriesIndex:[1],inRange:{color:["#00467F","#A5CC82"]}},geo:{show:!0,map:s,label:{normal:{show:!1},emphasis:{show:!1}},roam:!0,itemStyle:{normal:{areaColor:"#0031A8",borderColor:"#1180c7"},emphasis:{itemStyle:{areaColor:"#ffd917"}}}},series:[{name:"散点",type:"scatter",coordinateSystem:"geo",data:o(c),symbolSize:n=>n[2]/10,label:{normal:{formatter:"{b}",position:"right",show:!0},emphasis:{show:!0}},itemStyle:{normal:{color:"#05C3F9"}},zlevel:2},{type:"map",map:s,geoIndex:0,aspectScale:.75,showLegendSymbol:!1,label:{normal:{show:!0},emphasis:{show:!1,textStyle:{color:"#fff"}}},roam:!0,itemStyle:{normal:{areaColor:"#031525",borderColor:"#3B5077"},emphasis:{areaColor:"#2B91B7"}},animation:!1,data:c},{name:"点",type:"scatter",coordinateSystem:"geo",symbol:"pin",symbolSize:(n,v)=>{const L=c.reduce((_,S,H,J)=>(S.value>=_&&(_=S.value),_),c[0].value),E=40,x=25,$=parseFloat((L/E).toPrecision(2)),C=n[2]/$;return C<=x?x:C},label:{show:!0,fontSize:11,formatter:n=>n.data.value.pop()},itemStyle:{normal:{color:"#F62157"}},zlevel:6,data:o(c)},{name:"Top 5",type:"effectScatter",coordinateSystem:"geo",data:o(c.sort((n,v)=>v.value-n.value).slice(0,5)),symbolSize:function(n){return n[2]/10},showEffectOn:"render",rippleEffect:{brushType:"stroke"},hoverAnimation:!0,label:{normal:{formatter:"{b}",position:"right",show:!0}},itemStyle:{normal:{color:"yellow",shadowBlur:10,shadowColor:"yellow"}},zlevel:4}]};m.value.setOption(l),m.value.hideLoading()}const i={};return M(async()=>{const e=document.getElementById("chart");await u(e)}),window.addEventListener("resize",()=>{m.value.resize()}),(e,a)=>(y(),w("div",R,U))}}),G={class:"analysis-dash"},Z=b({__name:"index",setup(h){const m=new O,c=f(),s=f({image:{total:0,today:0,label:"图片数量",bgcolor:"#f0f9eb",cover:"PictureFilled",color:"#9ee974",unit:""},bucket:{total:0,today:0,label:"存储桶数量",bgcolor:"#ecf5ff",cover:"Coffee",color:"#6fb4fb",unit:""},album:{total:0,today:0,label:"相册数量",bgcolor:"#fef0f0",cover:"CameraFilled",color:"#f19797",unit:""},user:{total:0,today:0,label:"用户数量",bgcolor:"#f8ebff",cover:"User",color:"#c889e9",unit:""},wiki:{total:0,today:0,label:"知识库数量",bgcolor:"#c9f2ff",cover:"Collection",color:"#4bb7d9",unit:""},article:{total:0,today:0,label:"文章数量",bgcolor:"#fdf6ec",cover:"Document",color:"#fbcb87",unit:""}}),d=f({}),o=f(!1);function u(){m.banner("admin").then(e=>{c.value=e,Object.keys(e).forEach(a=>{s.value[a]&&(s.value[a].today=e[a].today,s.value[a].total=e[a].total)})})}u();function i(){o.value=!0,m.percentData("admin").then(e=>{d.value=e,console.log(e),o.value=!1})}return i(),(e,a)=>{const l=B("el-col"),n=B("el-row"),v=N("loading");return j((y(),w("div",G,[t(n,null,{default:r(()=>[t(l,{xl:4,lg:8,md:12},{default:r(()=>[t(p,{item:s.value.image},null,8,["item"])]),_:1}),t(l,{xl:4,lg:8,md:12},{default:r(()=>[t(p,{item:s.value.bucket},null,8,["item"])]),_:1}),t(l,{xl:4,lg:8,md:12},{default:r(()=>[t(p,{item:s.value.album},null,8,["item"])]),_:1}),t(l,{xl:4,lg:8,md:12},{default:r(()=>[t(p,{item:s.value.wiki},null,8,["item"])]),_:1}),t(l,{xl:4,lg:8,md:12},{default:r(()=>[t(p,{item:s.value.article},null,8,["item"])]),_:1}),t(l,{xl:4,lg:8,md:12},{default:r(()=>[t(p,{item:s.value.user},null,8,["item"])]),_:1})]),_:1}),t(n,null,{default:r(()=>[t(l,{xl:12,lg:12},{default:r(()=>[t(g,{style:{height:"400px"},title:"用户增长图"},{default:r(()=>[t(Y,{data:d.value.stats},null,8,["data"])]),_:1})]),_:1}),t(l,{xl:12,lg:12},{default:r(()=>[t(g,{style:{height:"400px"},title:"访问动态分布"},{default:r(()=>[t(q)]),_:1})]),_:1})]),_:1}),t(n,null,{default:r(()=>[t(l,null,{default:r(()=>[t(g,{style:{height:"400px"},title:"近一年内数据统计"},{default:r(()=>[t(F,{data:d.value.stats},null,8,["data"])]),_:1})]),_:1})]),_:1})])),[[v,o.value]])}}});export{Z as default};

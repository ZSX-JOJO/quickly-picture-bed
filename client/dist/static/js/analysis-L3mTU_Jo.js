import{_ as p,a as b,b as L}from"./recent-year.vue_vue_type_style_index_0_lang-cTnf2oCu.js";import{f as h,o as f,g,z as B,I as s,B as k,a8 as F,a9 as I,r as m,F as Y,C as A,v as M,l as O,h as e,x as a,L as S,am as z,$ as N,an as V,w as E,j as R,s as W,i as $,y as j}from"./vendor-DwjfiTos.js";import{_ as P}from"./index-LJ8e8yHT.js";import{L as y}from"./Log-6eRZo4F2.js";import{u as D}from"./date-time-ZUNy4mC1.js";const T=_=>(F("data-v-2089ff2c"),_=_(),I(),_),G={class:"log-item"},q={key:0,class:"log-item-avatar"},H=T(()=>s("img",{src:"https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif?imageView2/1/w/80/h/80",alt:""},null,-1)),J=[H],K={class:"log-item-meta"},Q={class:"log-item-title"},U={class:"log-item-desc"},X=h({__name:"item",props:{log:{default:()=>({id:"asdas2d42asd",type:1,operate_id:"ID:2366",operate_cont:"509036ffc9a69659.png",content:"上传了图片",createdAt:"2022-10-11 10:47:25"})},showAvatar:{type:Boolean,default:!1}},setup(_){return(n,i)=>(f(),g("div",G,[n.showAvatar?(f(),g("div",q,J)):B("",!0),s("div",K,[s("div",Q,[s("span",null,k(n.log.operate_cont),1),s("span",null,"("+k(n.log.client_info?n.log.client_info.province+n.log.client_info.city:"未知")+")",1)]),s("div",U,k(n.log.createdAt),1)])]))}}),Z=P(X,[["__scopeId","data-v-2089ff2c"]]),ee={class:"recent-log"},te=s("div",{class:"recent-log__header"},"近期动态(近一周)",-1),ae={class:"recent-log__content"},le=h({__name:"recent-log",setup(_){const n=new y,i=m([]);function t(){n.rencentLog().then(l=>{i.value=l.map(u=>(u.createdAt=D(u.createdAt),u))})}return t(),(l,u)=>(f(),g("div",ee,[te,s("div",ae,[(f(!0),g(Y,null,A(i.value,(v,d)=>(f(),M(Z,{key:d,log:v},null,8,["log"]))),128))])]))}}),oe={class:"contributes-container"},ne=s("div",{class:"calender-title"},"系统贡献度",-1),se={class:"calender-heatmap"},ie=s("span",null,"最近一年贡献：xxx 次",-1),ce=s("span",null,"最长连续贡献：xx 日",-1),re=s("span",null,"最近连续贡献：xx 日",-1),ue=s("div",{class:"vch__tips"},"贡献度的统计数据包括上传图片、删除图片、更新图片、登录记录，其中批量上传的图片会根据实际成功上传的图片数量来记录次数。",-1),de=h({__name:"contribute-item",setup(_){const n=new y,i=m([]),t=m(O().format("YYYY-MM-DD"));function l(){n.contributes({}).then(d=>{i.value=d})}l();function u(d){return d.count+"个贡献: "+D(d.date,"YYYY-MM-DD")}function v(d){console.log(d)}return(d,r)=>(f(),g("div",oe,[ne,s("div",se,[e(S(z),{"no-data-text":"当日无贡献",values:i.value,round:0,"end-date":t.value,"tooltip-unit":"贡献",locale:{less:"少",more:"多",on:"",days:["周日","周一","周二","周三","周四","周五","周六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},vertical:!1,"tooltip-formatter":u,"range-color":["#ebedf0","#dae2ef","#c0ddf9","#73b3f3","#3886e1","#17459e"],onDayClick:v},{"vch__legend-left":a(()=>[ie,ce,re]),_:1},8,["values","end-date"]),ue])]))}}),_e=["id"],w=h({__name:"pie-chart",props:{data:{},index:{},serieName:{}},setup(_){const n=_,i=m();return N(()=>{const t=document.getElementById("bucket-image-"+n.index);i.value=V(t,"westeros"),i.value.setOption({tooltip:{trigger:"item"},legend:{show:!1},series:[{name:n.serieName,type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:18,fontWeight:"bold"}},labelLine:{show:!1},data:[]}]});const l=new ResizeObserver(u=>{i.value.resize()});t&&l.observe(t)}),E(()=>n.data,t=>{t&&t.length&&R(()=>{i.value.setOption({series:{data:t}})})},{immediate:!0,deep:!0}),(t,l)=>(f(),g("div",{id:"bucket-image-"+t.index,class:"stats-chart"},null,8,_e))}}),me={class:"analysis-dash"},he=h({__name:"analysis",setup(_){const n=new y,i=m(),t=m({image:{total:0,today:0,label:"图片数量",bgcolor:"#f0f9eb",cover:"PictureFilled",color:"#9ee974",unit:""},bucket:{total:0,today:0,label:"存储桶数量",bgcolor:"#ecf5ff",cover:"Coffee",color:"#6fb4fb",unit:""},album:{total:0,today:0,label:"相册数量",bgcolor:"#fef0f0",cover:"CameraFilled",color:"#f19797",unit:""},plugin:{total:0,today:0,label:"插件安装数量",bgcolor:"#f8ebff",cover:"WalletFilled",color:"#c889e9",unit:""},wiki:{total:0,today:0,label:"知识库数量",bgcolor:"#c9f2ff",cover:"Collection",color:"#4bb7d9",unit:""},article:{total:0,today:0,label:"文章数量",bgcolor:"#fdf6ec",cover:"Document",color:"#fbcb87",unit:""}}),l=m({}),u=m(!1);function v(){n.banner().then(r=>{i.value=r,Object.keys(r).forEach(o=>{t.value[o]&&(t.value[o].today=r[o].today,t.value[o].total=r[o].total)})})}v();function d(){u.value=!0,n.percentData().then(r=>{l.value=r,l.value.bucket_image=r.bucket_image.map(o=>({name:o.bucket_name,value:o.count})),l.value.album_image=r.album_image.map(o=>({name:o.album_name,value:o.count})),l.value.wiki_article=r.wiki_article.map(o=>({name:o.wiki_name,value:o.count})),l.value.bucket_storage=r.bucket_storage.map(o=>({name:o.bucket_name,value:((o.count||0)/(1024*1024)).toFixed(2)})),u.value=!1})}return d(),(r,o)=>{const c=$("el-col"),x=$("el-row"),C=j("loading");return W((f(),g("div",me,[e(x,null,{default:a(()=>[e(c,{xl:4,lg:8,md:12},{default:a(()=>[e(p,{item:t.value.image},null,8,["item"])]),_:1}),e(c,{xl:4,lg:8,md:12},{default:a(()=>[e(p,{item:t.value.bucket},null,8,["item"])]),_:1}),e(c,{xl:4,lg:8,md:12},{default:a(()=>[e(p,{item:t.value.album},null,8,["item"])]),_:1}),e(c,{xl:4,lg:8,md:12},{default:a(()=>[e(p,{item:t.value.wiki},null,8,["item"])]),_:1}),e(c,{xl:4,lg:8,md:12},{default:a(()=>[e(p,{item:t.value.article},null,8,["item"])]),_:1}),e(c,{xl:4,lg:8,md:12},{default:a(()=>[e(p,{item:t.value.plugin},null,8,["item"])]),_:1})]),_:1}),e(x,{class:"contributes-row"},{default:a(()=>[e(c,{xl:16,lg:16},{default:a(()=>[e(de)]),_:1}),e(c,{xl:8,lg:8},{default:a(()=>[e(le)]),_:1})]),_:1}),e(x,null,{default:a(()=>[e(c,{xl:6,lg:12},{default:a(()=>[e(b,{title:"存储桶图片占比",unit:"张"},{default:a(()=>[e(w,{"serie-name":"图片数量",data:l.value.bucket_image,index:1},null,8,["data"])]),_:1})]),_:1}),e(c,{xl:6,lg:12},{default:a(()=>[e(b,{title:"相册图片占比",unit:"张"},{default:a(()=>[e(w,{"serie-name":"图片数量",data:l.value.album_image,index:2},null,8,["data"])]),_:1})]),_:1}),e(c,{xl:6,lg:12},{default:a(()=>[e(b,{title:"存储桶容量占比",unit:"M"},{default:a(()=>[e(w,{"serie-name":"占用存储大小",data:l.value.bucket_storage,index:3},null,8,["data"])]),_:1})]),_:1}),e(c,{xl:6,lg:12},{default:a(()=>[e(b,{title:"知识库文章占比",unit:"篇"},{default:a(()=>[e(w,{"serie-name":"文章数量",data:l.value.wiki_article,index:4},null,8,["data"])]),_:1})]),_:1})]),_:1}),e(x,null,{default:a(()=>[e(c,null,{default:a(()=>[e(b,{style:{height:"400px"},title:"近一年内数据统计"},{default:a(()=>[e(L,{data:l.value.stats},null,8,["data"])]),_:1})]),_:1})]),_:1})])),[[C,u.value]])}}});export{he as default};

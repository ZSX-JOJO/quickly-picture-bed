<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <button id="btn">点击</button>
  <script>
    const btn = document.querySelector('#btn')
    btn.addEventListener('click', () => {
      const eventSource = new EventSource('http://localhost:3002/')
      eventSource.onopen = () => {
        console.log('连接成功')
      }
      eventSource.onmessage = (e) => {
        console.log(e.data)
      }
      eventSource.onerror = () => {
        console.log('报错了')
      }
      eventSource.addEventListener('test', (e) => {
        console.log(e)
      });
    })

    ;(function noDebuger(){
      function testDebuger(){
        var d=new Date();
        debugger;
        if(new Date()-d>10){
            document.body.innerHTML='<div>年轻人，不要太好奇</div>';
            return true;
        }
        return false;
      }
    
      function start(){
        while(testDebuger()){
          testDebuger();
        }
      }

      if(!testDebuger()) {
        window.onblur = function(){
          setTimeout(function(){
            start();
          },500)
        }
      } else{
        start();
      }
    })();
  </script>
</body>
</html>